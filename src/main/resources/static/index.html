<!DOCTYPE html>
<html lang="ko">
<head>
   <meta charset="UTF-8">
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
   <title>Git Merge Game</title>
   <style>
       * {
           margin: 0;
           padding: 0;
           box-sizing: border-box;
       }
       
       body {
           font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', system-ui, sans-serif;
           background: #0a0a0a;
           color: #e8e8e8;
           min-height: 100vh;
       }
       
       .container {
           max-width: 1200px;
           margin: 0 auto;
           padding: 0 20px;
       }
       
       .header {
           background: #111111;
           border-bottom: 1px solid #1a1a1a;
           padding: 20px 0;
           position: sticky;
           top: 0;
           z-index: 100;
       }
       
       .header-content {
           display: flex;
           justify-content: space-between;
           align-items: center;
       }
       
       .logo {
           font-size: 24px;
           font-weight: 700;
           color: #ffffff;
           display: flex;
           align-items: center;
           gap: 12px;
       }
       
       .logo::before {
           content: "⚡";
           font-size: 28px;
       }
       
       .nav-buttons {
           display: flex;
           gap: 16px;
       }
       
       .btn {
           background: #1a1a1a;
           color: #e8e8e8;
           border: 1px solid #2a2a2a;
           border-radius: 8px;
           padding: 12px 24px;
           font-size: 14px;
           font-weight: 500;
           cursor: pointer;
           transition: all 0.2s ease;
           text-decoration: none;
           display: inline-flex;
           align-items: center;
           gap: 8px;
       }
       
       .btn:hover {
           background: #2a2a2a;
           border-color: #3a3a3a;
           transform: translateY(-1px);
       }
       
       .btn.primary {
           background: #ffffff;
           color: #0a0a0a;
           border-color: #ffffff;
       }
       
       .btn.primary:hover {
           background: #f0f0f0;
           border-color: #f0f0f0;
       }
       
       .hero {
           text-align: center;
           padding: 80px 0;
       }
       
       .hero h1 {
           font-size: 64px;
           font-weight: 800;
           color: #ffffff;
           margin-bottom: 20px;
           letter-spacing: -2px;
       }
       
       .hero p {
           font-size: 20px;
           color: #888888;
           margin-bottom: 40px;
           line-height: 1.6;
       }
       
       .hero-buttons {
           display: flex;
           justify-content: center;
           gap: 20px;
           margin-bottom: 60px;
       }
       
       .room-section {
           margin-bottom: 60px;
       }
       
       .section-header {
           display: flex;
           justify-content: space-between;
           align-items: center;
           margin-bottom: 30px;
       }
       
       .section-title {
           font-size: 24px;
           font-weight: 600;
           color: #ffffff;
       }
       
       .room-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
           gap: 20px;
       }
       
       .room-card {
           background: #111111;
           border: 1px solid #1a1a1a;
           border-radius: 12px;
           padding: 24px;
           transition: all 0.2s ease;
           cursor: pointer;
       }
       
       .room-card:hover {
           border-color: #2a2a2a;
           transform: translateY(-2px);
           box-shadow: 0 8px 24px rgba(0, 0, 0, 0.4);
       }
       
       .room-header {
           display: flex;
           justify-content: space-between;
           align-items: flex-start;
           margin-bottom: 16px;
       }
       
       .room-name {
           font-size: 18px;
           font-weight: 600;
           color: #ffffff;
       }
       
       .room-status {
           display: flex;
           align-items: center;
           gap: 8px;
           font-size: 14px;
           color: #888888;
       }
       
       .status-dot {
           width: 8px;
           height: 8px;
           border-radius: 50%;
           background: #00ff88;
       }
       
       .status-dot.full {
           background: #ff4444;
       }
       
       .participant-count {
           font-size: 16px;
           font-weight: 500;
           color: #ffffff;
           margin-bottom: 12px;
       }
       
       .participants {
           display: flex;
           gap: 8px;
           margin-bottom: 16px;
       }
       
       .participant {
           background: #1a1a1a;
           border: 1px solid #2a2a2a;
           border-radius: 6px;
           padding: 6px 12px;
           font-size: 12px;
           color: #cccccc;
       }
       
       .room-time {
           font-size: 12px;
           color: #666666;
       }
       
       .create-room {
           border: 2px dashed #2a2a2a;
           display: flex;
           flex-direction: column;
           align-items: center;
           justify-content: center;
           min-height: 180px;
           text-align: center;
       }
       
       .create-room:hover {
           border-color: #3a3a3a;
       }
       
       .create-icon {
           font-size: 32px;
           margin-bottom: 12px;
           opacity: 0.7;
       }
       
       .create-text {
           font-size: 16px;
           font-weight: 500;
           color: #cccccc;
           margin-bottom: 8px;
       }
       
       .create-desc {
           font-size: 14px;
           color: #888888;
       }
       
       .stats {
           background: #111111;
           border: 1px solid #1a1a1a;
           border-radius: 12px;
           padding: 24px;
           margin-bottom: 40px;
       }
       
       .stats-grid {
           display: grid;
           grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
           gap: 24px;
       }
       
       .stat-item {
           text-align: center;
       }
       
       .stat-value {
           font-size: 32px;
           font-weight: 700;
           color: #ffffff;
           margin-bottom: 8px;
       }
       
       .stat-label {
           font-size: 14px;
           color: #888888;
           text-transform: uppercase;
           letter-spacing: 0.5px;
       }
       
       .loading {
           text-align: center;
           color: #666666;
           padding: 40px;
       }
       
       .loading::before {
           content: "⚡";
           font-size: 24px;
           display: block;
           margin-bottom: 12px;
           opacity: 0.5;
       }
       
       @keyframes pulse {
           0%, 100% { opacity: 1; }
           50% { opacity: 0.5; }
       }
       
       .loading {
           animation: pulse 2s infinite;
       }
   </style>
</head>
<body>
   <div class="header">
       <div class="container">
           <div class="header-content">
               <div class="logo">Git Merge Game</div>
               <div class="nav-buttons">
                   <button class="btn">랭킹</button>
                   <button class="btn">프로필</button>
                   <button class="btn primary">로그인</button>
               </div>
           </div>
       </div>
   </div>
   
   <div class="container">
       <div class="hero">
           <h1>Merge or Die</h1>
           <p>실시간 Git 충돌 해결 배틀<br>최고의 개발자가 되어보세요</p>
           <div class="hero-buttons">
               <button class="btn primary" onclick="createRoom()">빠른 매칭</button>
               <button class="btn" onclick="scrollToRooms()">방 찾기</button>
           </div>
       </div>
       
       <div class="stats">
           <div class="stats-grid">
               <div class="stat-item">
                   <div class="stat-value" id="onlineUsers">0</div>
                   <div class="stat-label">온라인</div>
               </div>
               <div class="stat-item">
                   <div class="stat-value" id="activeRooms">0</div>
                   <div class="stat-label">활성 방</div>
               </div>
               <div class="stat-item">
                   <div class="stat-value" id="totalGames">1,247</div>
                   <div class="stat-label">총 게임</div>
               </div>
               <div class="stat-item">
                   <div class="stat-value" id="avgTime">2:34</div>
                   <div class="stat-label">평균 시간</div>
               </div>
           </div>
       </div>
       
       <div class="room-section">
           <div class="section-header">
               <div class="section-title">활성 방 목록</div>
               <button class="btn" onclick="loadRooms()">새로고침</button>
           </div>
           <div class="room-grid" id="roomGrid">
               <div class="loading">방 목록을 불러오는 중</div>
           </div>
       </div>
   </div>
   
   <script>
       let currentUser = 'Player_' + Math.floor(Math.random() * 10000);
       
       document.addEventListener('DOMContentLoaded', function() {
           loadRooms();
           updateStats();
       });
       
       async function loadRooms() {
           try {
               const response = await fetch('/api/matches/rooms?gameId=1');
               const data = await response.json();
               renderRooms(data.rooms);
               updateStats(data.rooms.length);
           } catch (error) {
               console.error('방 목록 로딩 실패:', error);
               document.getElementById('roomGrid').innerHTML = 
                   '<div class="loading">방 목록을 불러올 수 없습니다</div>';
           }
       }
       
       function renderRooms(rooms) {
           const grid = document.getElementById('roomGrid');
           
           let html = `
               <div class="room-card create-room" onclick="createRoom()">
                   <div class="create-icon">+</div>
                   <div class="create-text">새 방 만들기</div>
                   <div class="create-desc">원하는 설정으로 방을 생성하세요</div>
               </div>
           `;
           
           if (rooms && rooms.length > 0) {
               rooms.forEach(room => {
                   const isFull = room.currentCount >= room.maxCount;
                   html += `
                       <div class="room-card ${isFull ? 'full' : ''}" onclick="${isFull ? '' : `joinRoom(${room.matchId})`}">
                           <div class="room-header">
                               <div class="room-name">${room.roomName}</div>
                               <div class="room-status">
                                   <div class="status-dot ${isFull ? 'full' : ''}"></div>
                                   ${isFull ? '만석' : '대기중'}
                               </div>
                           </div>
                           <div class="participant-count">${room.currentCount}/${room.maxCount} 참가자</div>
                           <div class="participants">
                               ${room.participantNames.slice(0, 4).map(name => 
                                   `<div class="participant">${name}</div>`
                               ).join('')}
                               ${room.participantNames.length > 4 ? 
                                   `<div class="participant">+${room.participantNames.length - 4}</div>` : ''
                               }
                           </div>
                           <div class="room-time">${getTimeAgo(room.createdAt)}</div>
                       </div>
                   `;
               });
           }
           
           grid.innerHTML = html;
       }
       
       async function createRoom() {
           try {
               const response = await fetch('/api/matches/join', {
                   method: 'POST',
                   headers: { 'Content-Type': 'application/json' },
                   body: JSON.stringify({
                       gameId: 1,
                       nickname: currentUser
                   })
               });
               
               const data = await response.json();
               
               if (response.ok) {
                   alert(`방 생성 완료!\n방 이름: ${data.roomName}\n${data.message}`);
                   loadRooms();
               } else {
                   alert(data.error || '방 생성에 실패했습니다');
               }
           } catch (error) {
               console.error('방 생성 실패:', error);
               alert('방 생성에 실패했습니다');
           }
       }
       
       async function joinRoom(matchId) {
           try {
               const response = await fetch('/api/matches/join', {
                   method: 'POST',
                   headers: { 'Content-Type': 'application/json' },
                   body: JSON.stringify({
                       gameId: 1,
                       nickname: currentUser,
                       matchId: matchId
                   })
               });
               
               const data = await response.json();
               
               if (response.ok) {
                   alert(`방 참가 완료!\n${data.message}`);
                   loadRooms();
               } else {
                   alert(data.error || '방 참가에 실패했습니다');
               }
           } catch (error) {
               console.error('방 참가 실패:', error);
               alert('방 참가에 실패했습니다');
           }
       }
       
       function updateStats(roomCount = 0) {
           document.getElementById('onlineUsers').textContent = Math.floor(Math.random() * 50) + 20;
           document.getElementById('activeRooms').textContent = roomCount;
       }
       
       function scrollToRooms() {
           document.querySelector('.room-section').scrollIntoView({ 
               behavior: 'smooth' 
           });
       }
       
       function getTimeAgo(dateString) {
           const now = new Date();
           const date = new Date(dateString);
           const diffMs = now - date;
           const diffMins = Math.floor(diffMs / 60000);
           
           if (diffMins < 1) return '방금 전';
           if (diffMins < 60) return `${diffMins}분 전`;
           
           const diffHours = Math.floor(diffMins / 60);
           if (diffHours < 24) return `${diffHours}시간 전`;
           
           const diffDays = Math.floor(diffHours / 24);
           return `${diffDays}일 전`;
       }
       
       setInterval(loadRooms, 10000);
   </script>
</body>
</html>
